
<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <title>Office Click-To-Run Configuration XML Editor</title>
    <meta name="generator" content="OfficeClick-To-RunXmlEditor" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="description" content="Office Click-To-Run Configuration XML Editor" />

  
    <script type="text/javascript" src="./Scripts/vkbeautify.0.99.00.beta.js"></script>
    
    <link href="/Content/bootstrap.min.css" rel="stylesheet">
    <!--<link rel="stylesheet" href="/Content/bootstrap-datetimepicker.css" />-->

    <!--[if lt IE 9]>
      <script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!--<link rel="apple-touch-icon" href="/bootstrap/img/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/bootstrap/img/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/bootstrap/img/apple-touch-icon-114x114.png">-->

    <!-- CSS code from Bootply.com editor -->

    <style type="text/css">
        
        .navbar-static-top {
            margin-bottom: 20px;
            background-color: #dc3c00;
        }

        i {
            font-size: 16px;
        }

        .nav > li > a {
            color: #787878;
        }

        footer {
            margin-top: 20px;
            padding-top: 20px;
            padding-bottom: 20px;
            background-color: #efefef;
        }

        /* count indicator near icons */
        .nav > li .count {
            position: absolute;
            bottom: 12px;
            right: 6px;
            font-size: 9px;
            background: rgba(51,200,51,0.55);
            color: rgba(255,255,255,0.9);
            line-height: 1em;
            padding: 2px 4px;
            -webkit-border-radius: 10px;
            -moz-border-radius: 10px;
            -ms-border-radius: 10px;
            -o-border-radius: 10px;
            border-radius: 10px;
        }

        #cbProduct {
        }

        #cbEdition {
        }

        div.alert table{border-bottom:none;border-right:none;border-collapse:separate;border-spacing:0;}div#content div.alert td,div#content div.alert th{border-top:none;border-left:none;background-clip:padding-box;}div.alert th{background-color:#ededed;font-weight:bold;}div.alert img{padding-right:5px;border:0;}div.alert p{margin:0;}

        .cl_IC101471{background:url('https://i-technet.sec.s-msft.com/Areas/Epx/Content/Images/ImageSprite.png?v=635736413806036745') no-repeat scroll -1228px -3px;width:16px;height:14px;overflow:hidden;}



    </style>

</head>

<!-- HTML code from Bootply.com editor -->

<body>
    <div id="top-nav" class="navbar navbar-inverse navbar-static-top" style="min-width: 550px">
        <div class="container-fluid">
            <div class="navbar-header">

                <table cellspacing="0" cellpadding="0">
                    <tr>
                        <td style="width: 30px;text-align: center">
                            <img src="./images/Office.png" alt="" height="40" style="padding-top: 3px" />
                        </td>
                        <td style="padding-left: 10px">
                            <a class="navbar-brand" href="#" style="color:white; font-family:segoe ui">Office Click-To-Run Configuration XML Editor</a>
                        </td>
                    </tr>
                </table>

            </div>
        </div>
        <!-- /container -->
    </div>

    <!-- /Header -->
    <!-- Main -->
    <div class="container-fluid">
        <div class="row">
            <!-- /col-3 -->
            <div class="col-sm-12">
                <div class="row">

                    <div class="col-md-5" style="min-width: 550px;padding-right: 40px">
                        <!--tabs-->
                        <div class="panel">
                            <ul class="nav nav-tabs" id="myTab">
                                <li class="active"><a href="#profile" data-toggle="tab">Add Product</a></li>
                                <li><a href="#removeproduct" data-toggle="tab">Remove Product</a></li>
                                <li><a href="#updates" data-toggle="tab">Updates</a></li>
                                <li><a href="#display" data-toggle="tab">Display</a></li>
                                <li><a href="#logging" data-toggle="tab">Logging</a></li>
                            </ul>
                            <div class="tab-content">

                                <!-- Add Product-->
                                <div class="tab-pane active well" id="profile">
                                    <div class="panel panel-default">
                                        <div class="panel-heading">
                                            <div class="panel-title">
                                                <h4>Add Product</h4>
                                            </div>
                                        </div>

                                        <div class="panel-body">
                                            <form class="form form-vertical">

                                                <div class="control-group" style="padding-top: 5px;">
                                                    <table>
                                                        <tr>
                                                            <td>
                                                                <label>Product</label>
                                                            </td>
                                                            <td style="width: 30px;text-align: center;cursor:pointer;">
                                                                <a data-toggle="modal" data-target="#myModal" class="glyphicon glyphicon-info-sign"></a>
                                                            </td>
                                                        </tr>
                                                    </table>
                                                    
                                                    <div class="controls">
                                                        <select id="cbProduct" class="form-control">
                                                            <option value="O365ProPlusRetail">Office 365 ProPlus Retail</option>
                                                            <option value="O365BusinessRetail">Office 365 Business Retail</option>
                                                            <option value="VisioProRetail">Visio Professional Retail</option>
                                                            <option value="ProjectProRetail">Project Professional Retail</option>
                                                            <option value="SPDRetail">SharePoint Designer</option>
                                                        </select>
                                                    </div>

                                                </div>

                                                <div class="control-group" style="padding-top: 5px;">
                                                    <table>
                                                        <tr>
                                                            <td>
                                                                <label>Edition</label>
                                                            </td>
                                                            <td style="width: 30px;text-align: center;cursor:pointer;">
                                                                <a data-toggle="modal" data-target="#bitnessModal" class="glyphicon glyphicon-info-sign"></a>
                                                            </td>
                                                        </tr>
                                                    </table>

                                                    <div class="controls">
                                                        <select id="cbEdition" class="form-control">
                                                            <option value="32">32-bit</option>
                                                            <option value="64">64-bit</option>
                                                        </select>
                                                    </div>
                                                </div>

                                                <div class="control-group" style="padding-top: 5px;">
                                                    <table>
                                                        <tr>
                                                            <td>
                                                                <label>Language</label>
                                                            </td>
                                                            <td style="width: 30px;text-align: center;cursor:pointer;">
                                                                <a data-toggle="modal" data-target="#languageModal" class="glyphicon glyphicon-info-sign"></a>
                                                            </td>
                                                        </tr>
                                                    </table>

                                                    <div class="controls" style="min-width: 400px; overflow: auto;">
                                                        <div style="float: left; width: 100%">
                                                            <table >
                                                                <tr>
                                                                    <td style="width: 100%; padding-right: 10px">
                                                                        <select id="cbLanguage" class="form-control">
                                                                            <option value="en-us">English (en-us)</option>
                                                                            <option value="ar-sa">Arabic (ar-sa)</option>
                                                                            <option value="bg-bg">Bulgarian (bg-bg)</option>
                                                                            <option value="zh-cn">Chinese (Simplified) (zh-cn)</option>
                                                                            <option value="zh-tw">Chinese (zh-tw)</option>
                                                                            <option value="hr-hr">Croatian (hr-hr)</option>
                                                                            <option value="cs-cz">Czech (cs-cz)</option>
                                                                            <option value="da-dk">Danish (da-dk)</option>
                                                                            <option value="nl-nl">Dutch (nl-nl)</option>
                                                                            <option value="et-ee">Estonian (et-ee)</option>
                                                                            <option value="fi-fi">Finnish (fi-fi)</option>
                                                                            <option value="fr-fr">French (fr-fr)</option>
                                                                            <option value="de-de">German (de-de)</option>
                                                                            <option value="el-gr">Greek (el-gr)</option>
                                                                            <option value="he-il">Hebrew (he-il)</option>
                                                                            <option value="hi-in">Hindi (hi-in)</option>
                                                                            <option value="hu-hu">Hungarian (hu-hu)</option>
                                                                            <option value="id-id">Indonesian (id-id)</option>
                                                                            <option value="it-it">Italian (it-it)</option>
                                                                            <option value="ja-jp">Japanese (ja-jp)</option>
                                                                            <option value="kk-kh">Kazakh (kk-kh)</option>
                                                                            <option value="ko-kr">Korean (ko-kr)</option>
                                                                            <option value="lv-lv">Latvian (lv-lv)</option>
                                                                            <option value="lt-lt">Lithuanian (lt-lt)</option>
                                                                            <option value="ms-my">Malay (ms-my)</option>
                                                                            <option value="nb-no">Norwegian (Bokm�l) (nb-no)</option>
                                                                            <option value="pl-pl">Polish (pl-pl)</option>
                                                                            <option value="pt-br">Portuguese (pt-br)</option>
                                                                            <option value="pt-pt">Portuguese (pt-pt)</option>
                                                                            <option value="ro-ro">Romanian (ro-ro)</option>
                                                                            <option value="ru-ru">Russian (ru-ru)</option>
                                                                            <option value="sr-latn-rs">Serbian (Latin) (sr-latn-rs)</option>
                                                                            <option value="sk-sk">Slovak (sk-sk)</option>
                                                                            <option value="sl-si">Slovenian (sl-si)</option>
                                                                            <option value="es-es">Spanish (es-es)</option>
                                                                            <option value="sv-se">Swedish (sv-se)</option>
                                                                            <option value="th-th">Thai (th-th)</option>
                                                                            <option value="tr-tr">Turkish (tr-tr)</option>
                                                                            <option value="uk-ua">Ukrainian (uk-ua)</option>
                                                                        </select>
                                                                    </td>
                                                                    <td style="width: 150px;text-align: right; padding-right: 10px">
                                                                        <button id="btAddLanguage" class="btn btn-primary">
                                                                            Add
                                                                        </button>
                                                                    </td>
                                                                    <td style="width:80px;text-align: right">
                                                                        <button id="btRemoveLanguage" class="btn btn-primary" disabled="true">
                                                                            Remove
                                                                        </button>
                                                                    </td>
                                                                </tr>
                                                            </table>
                                                        </div>
 
                                                    </div>
                                                </div>

                                                <div class="control-group" >
                                                    <label></label>
                                                    <div class="controls">
                                                        <button id="btAddProduct" class="btn btn-primary">
                                                            Add Product
                                                        </button>
                                                        <button id="btRemoveProduct" class="btn btn-primary">
                                                            Delete Product
                                                        </button>
                                                    </div>
                                                </div>
                                            </form>
                                        </div>

                                        <!--/panel content-->
                                    </div>

                                    <div class="panel panel-default">
                                        <div class="panel-heading">
                                            <div class="panel-title">
                                                <table style="width: 100%">
                                                    <tr>
                                                        <td style="width: 100px">
                                                            <h4>Optional</h4> 
                                                        </td>
                                                        <td style="text-align: right;">
                                                            <a id="toggleExpand" data-toggle="collapse" data-parent="#accordion" href="#collapseOne" class="glyphicon glyphicon-collapse-up" onclick="toggleExpandOptional(this);">


                                                            </a>
                                                        </td>
                                                    </tr>
                                                </table>
                                                
                                                
                                            </div>
                                        </div>
                                        
                                        <div id="collapseOne" class="panel-collapse collapse in" style="height:0">
                                            <div class="panel-body">
                                                <form class="form form-vertical">

                                                    <div class="control-group">
                                                        <table>
                                                            <tr>
                                                                <td>
                                                                    <label>Version</label>
                                                                </td>
                                                                <td style="width: 30px;text-align: center;cursor:pointer;">
                                                                    <a data-toggle="modal" data-target="#versionModal" class="glyphicon glyphicon-info-sign"></a>
                                                                </td>
                                                            </tr>
                                                        </table>

                                                        <div class="controls">
                                                            <input id="txtVersion" type="text" class="form-control" placeholder="Version">
                                                        </div>
                                                    </div>

                                                    <div class="control-group" style="padding-top: 5px;">
                                                        <table>
                                                            <tr>
                                                                <td>
                                                                    <label>SourcePath</label>
                                                                </td>
                                                                <td style="width: 30px;text-align: center;cursor:pointer;">
                                                                    <a data-toggle="modal" data-target="#sourcepathModal" class="glyphicon glyphicon-info-sign"></a>
                                                                </td>
                                                            </tr>
                                                        </table>

                                                        <div class="controls">
                                                            <input id="txtSourcePath" type="text" class="form-control" placeholder="Enter Name">
                                                        </div>
                                                    </div>

                                                    <div class="control-group" style="padding-top: 5px;">
                                                        <table>
                                                            <tr>
                                                                <td>
                                                                    <label>PIDKEY</label>
                                                                </td>
                                                                <td style="width: 30px;text-align: center;cursor:pointer;">
                                                                    <a data-toggle="modal" data-target="#pidkeyModal" class="glyphicon glyphicon-info-sign"></a>
                                                                </td>
                                                            </tr>
                                                        </table>

                                                        <div class="controls">
                                                            <input id="txtPidKey" type="text" class="form-control" placeholder="XXXXX-XXXXX-XXXXX-XXXXX-XXXXX">
                                                        </div>
                                                    </div>


                                                    <div class="control-group" style="padding-top: 5px;">
                                                        <table>
                                                            <tr>
                                                                <td>
                                                                    <label>Exclude Office Programs</label>
                                                                </td>
                                                                <td style="width: 30px;text-align: center;cursor:pointer;">
                                                                    <a data-toggle="modal" data-target="#excludeappModal" class="glyphicon glyphicon-info-sign"></a>
                                                                </td>
                                                            </tr>
                                                        </table>

                                                        <div class="controls" style="min-width: 400px; overflow: auto;">
                                                            <div style="float: left; width: 100%">
                                                                <table>
                                                                    <tr>
                                                                        <td style="width: 100%; padding-right: 10px">
                                                                            <select id="cbExcludeApp" class="form-control">
                                                                                <option value="Access">Access</option>
                                                                                <option value="Excel">Excel</option>
                                                                                <option value="Groove">Groove</option>
                                                                                <option value="InfoPath">InfoPath</option>
                                                                                <option value="Lync">Lync</option>
                                                                                <option value="OneNote">OneNote</option>
                                                                                <option value="Outlook">Outlook</option>
                                                                                <option value="PowerPoint">PowerPoint</option>
                                                                                <option value="Project">Project</option>
                                                                                <option value="Publisher">Publisher</option>
                                                                                <option value="SharePointDesigner">SharePointDesigner</option>
                                                                                <option value="Visio">Visio</option>
                                                                                <option value="Word">Word</option>
                                                                            </select>
                                                                        </td>
                                                                        <td style="width: 150px;text-align: right; padding-right: 10px">
                                                                            <button id="btAddExcludeApp" class="btn btn-primary">
                                                                                Add
                                                                            </button>
                                                                        </td>
                                                                        <td style="width:80px;text-align: right">
                                                                            <button id="btRemoveExcludeApp" class="btn btn-primary" disabled="true">
                                                                                Remove
                                                                            </button>
                                                                        </td>
                                                                    </tr>
                                                                </table>
                                                            </div>

                                                        </div>
                                                    </div>

                                                    <br />

                                                    <div class="control-group">
                                                        <label></label>
                                                        <div class="controls">

                                                        </div>
                                                    </div>
                                                </form>
                                            </div>
                                        </div>
                                        
                                    </div>

                                </div>

                                <!-- Remove Product-->
                                <div class="tab-pane well" id="removeproduct">
                                    <div class="panel panel-default">
                                        <div class="panel-heading">
                                            <div class="panel-title">
                                                <h4>Add Remove Product</h4>
                                            </div>
                                        </div>

                                        <div class="panel-body">
                                            <form class="form form-vertical">

                                                <table style="width: 100%">
                                                    <tr>
                                                        <td>
                                                            <div class="btn-group" style="width:300px;min-width: 300px">
                                                                <button id="removeAllProducts" type="button" class="btn btn-default btn-primary" style="min-width: 120px" onclick="toggleRemove(this.id);">
                                                                    Remove All
                                                                </button>
                                                                <button id="removeSelectProducts" type="button" class="btn btn-default" style="min-width: 120px" onclick="toggleRemove(this.id);">
                                                                    Remove Select
                                                                </button>
                                                            </div>
                                                        </td>
                                                        <td style="width: 30px;text-align: center;cursor:pointer;">
                                                            <a data-toggle="modal" data-target="#removeproductsModal" class="glyphicon glyphicon-info-sign"></a>
                                                        </td>
                                                    </tr>
                                                </table>
                                                

                                                <br />
                                                <br />

                                                <div class="control-group" style="padding-top: 5px;">
                                                    <label>Product</label>
                                                    <div class="controls">
                                                        <select id="cbRemoveProduct" class="form-control" disabled="true">
                                                            <option value="O365ProPlusRetail">Office 365 ProPlus Retail</option>
                                                            <option value="O365BusinessRetail">Office 365 Business Retail</option>
                                                            <option value="VisioProRetail">Visio Professional Retail</option>
                                                            <option value="ProjectProRetail">Project Professional Retail</option>
                                                            <option value="SPDRetail">SharePoint Designer</option>
                                                        </select>
                                                    </div>
                                                </div>

                                                <div class="control-group" style="padding-top: 5px;">
                                                    <label>Language</label>
                                                    <div class="controls">
                                                                                                   
                                                        <table>
                                                            <tr>
                                                                <td style="width: 100%; padding-right: 10px">
                                                                    <select id="cbRemoveLanguage" class="form-control" disabled="true">
                                                                        <option value="en-us">English (en-us)</option>
                                                                        <option value="ar-sa">Arabic (ar-sa)</option>
                                                                        <option value="bg-bg">Bulgarian (bg-bg)</option>
                                                                        <option value="zh-cn">Chinese (Simplified) (zh-cn)</option>
                                                                        <option value="zh-tw">Chinese (zh-tw)</option>
                                                                        <option value="hr-hr">Croatian (hr-hr)</option>
                                                                        <option value="cs-cz">Czech (cs-cz)</option>
                                                                        <option value="da-dk">Danish (da-dk)</option>
                                                                        <option value="nl-nl">Dutch (nl-nl)</option>
                                                                        <option value="et-ee">Estonian (et-ee)</option>
                                                                        <option value="fi-fi">Finnish (fi-fi)</option>
                                                                        <option value="fr-fr">French (fr-fr)</option>
                                                                        <option value="de-de">German (de-de)</option>
                                                                        <option value="el-gr">Greek (el-gr)</option>
                                                                        <option value="he-il">Hebrew (he-il)</option>
                                                                        <option value="hi-in">Hindi (hi-in)</option>
                                                                        <option value="hu-hu">Hungarian (hu-hu)</option>
                                                                        <option value="id-id">Indonesian (id-id)</option>
                                                                        <option value="it-it">Italian (it-it)</option>
                                                                        <option value="ja-jp">Japanese (ja-jp)</option>
                                                                        <option value="kk-kh">Kazakh (kk-kh)</option>
                                                                        <option value="ko-kr">Korean (ko-kr)</option>
                                                                        <option value="lv-lv">Latvian (lv-lv)</option>
                                                                        <option value="lt-lt">Lithuanian (lt-lt)</option>
                                                                        <option value="ms-my">Malay (ms-my)</option>
                                                                        <option value="nb-no">Norwegian (Bokm�l) (nb-no)</option>
                                                                        <option value="pl-pl">Polish (pl-pl)</option>
                                                                        <option value="pt-br">Portuguese (pt-br)</option>
                                                                        <option value="pt-pt">Portuguese (pt-pt)</option>
                                                                        <option value="ro-ro">Romanian (ro-ro)</option>
                                                                        <option value="ru-ru">Russian (ru-ru)</option>
                                                                        <option value="sr-latn-rs">Serbian (Latin) (sr-latn-rs)</option>
                                                                        <option value="sk-sk">Slovak (sk-sk)</option>
                                                                        <option value="sl-si">Slovenian (sl-si)</option>
                                                                        <option value="es-es">Spanish (es-es)</option>
                                                                        <option value="sv-se">Swedish (sv-se)</option>
                                                                        <option value="th-th">Thai (th-th)</option>
                                                                        <option value="tr-tr">Turkish (tr-tr)</option>
                                                                        <option value="uk-ua">Ukrainian (uk-ua)</option>
                                                                    </select>
                                                                </td>
                                                                <td style="width: 150px;text-align: right; padding-right: 10px">
                                                                    <button id="btAddRemoveLanguage" class="btn btn-primary" disabled="true">
                                                                        Add
                                                                    </button>
                                                                </td>
                                                                <td style="width:80px;text-align: right">
                                                                    <button id="btRemoveRemoveLanguage" class="btn btn-primary" disabled="true">
                                                                        Remove
                                                                    </button>
                                                                </td>
                                                            </tr>
                                                        </table>

                                                    </div>
                                                </div>

                                                <br />

                                                <div class="control-group" style="padding-top: 5px;">
                                                    <label></label>
                                                    <div class="controls">
                                                        <button id="btAddRemoveProduct" class="btn btn-primary">
                                                            Add Remove Product
                                                        </button>
                                                        <button id="btDeleteRemoveProduct" class="btn btn-primary">
                                                            Delete Remove Product
                                                        </button>
                                                    </div>
                                                </div>
                                            </form>
                                        </div>

                                        <!--/panel content-->
                                    </div>
                                </div>

                                <!-- Updates-->
                                <div class="tab-pane well" id="updates">

                                    <div class="panel panel-default">
                                        <div class="panel-heading">
                                            <div class="panel-title">
                                                <h4>Updates</h4>
                                            </div>
                                        </div>

                                        <div class="panel-body">
                                            <form class="form form-vertical">

                                                <div class="btn-group" style="width:300px">
                                                    <button id="btupdatesEnabled" type="button" class="btn btn-default" style="min-width: 120px" onclick="toggleUpdatesEnabled(this.id);">
                                                        Enabled
                                                    </button>
                                                    <button id="btupdatesDisabled" type="button" class="btn btn-default" style="min-width: 120px" onclick="toggleUpdatesEnabled(this.id);">
                                                        Disabled
                                                    </button>
                                                </div>

                                                <br />
                                                <br />

                                                <div class="control-group">
                                                    <table>
                                                        <tr>
                                                            <td>
                                                                <label>UpdatePath</label>
                                                            </td>
                                                            <td style="width: 30px;text-align: center;cursor:pointer;">
                                                                <a data-toggle="modal" data-target="#updatepathModal" class="glyphicon glyphicon-info-sign"></a>
                                                            </td>
                                                        </tr>
                                                    </table>
                                                    
                                                    <div class="controls">
                                                        <input id="txtUpdatePath" type="text" class="form-control" placeholder="">
                                                    </div>
                                                </div>

                                                <div class="control-group" style="padding-top: 5px;">
                                                    <table>
                                                        <tr>
                                                            <td>
                                                                <label>TargetVersion</label>
                                                            </td>
                                                            <td style="width: 30px;text-align: center;cursor:pointer;">
                                                                <a data-toggle="modal" data-target="#targetversionModal" class="glyphicon glyphicon-info-sign"></a>
                                                            </td>
                                                        </tr>
                                                    </table>

                                                    <div class="controls">
                                                        <input id="txtTargetVersion" type="text" class="form-control" placeholder="">
                                                    </div>
                                                </div>

                                                <div class="control-group" style="padding-top: 5px;">
                                                    <table>
                                                        <tr>
                                                            <td>
                                                                <label>Deadline</label>
                                                            </td>
                                                            <td style="width: 30px;text-align: center;cursor:pointer;">
                                                                <a data-toggle="modal" data-target="#deadlineModal" class="glyphicon glyphicon-info-sign"></a>
                                                            </td>
                                                        </tr>
                                                    </table>
                                                    

                                                    <div class="controls">
                                                        <input id="txtDeadline" type="text" class="form-control" placeholder="" style="display: none">
                                                        
                                                        <div class='input-group date' id='txtDeadline'>
                                                            <input type='text' class="form-control" />
                                                            <span class="input-group-addon">
                                                                <span class="glyphicon glyphicon-calendar"></span>
                                                            </span>
                                                        </div>

                                                    </div>
                                                </div>

                                                <br />

                                                <div class="control-group">
                                                    <label></label>
                                                    <div class="controls">
                                                        <button id="btSaveUpdates" class="btn btn-primary">
                                                            Save
                                                        </button>
                                                        <button id="btRemovesUpdates" class="btn btn-primary">
                                                            Remove
                                                        </button>
                                                    </div>
                                                </div>
                                            </form>
                                        </div>

                                        <!--/panel content-->
                                    </div>

                                </div>

                                <!-- Display-->
                                <div class="tab-pane well" id="display">

                                    <div class="panel panel-default">
                                        <div class="panel-heading">
                                            <div class="panel-title">
                                                <h4>Display</h4>
                                            </div>
                                        </div>

                                        <div class="panel-body">
                                            <form class="form form-vertical">
                                                
                                                <div>
                                                    <label>Level</label>
                                                </div>
                                                <div>
                                                    <div class="btn-group" style="width:300px">

                                                        <button id="btLevelNone" type="button" class="btn btn-default" style="min-width: 120px" onclick="toggleDisplayLevelEnabled(this.id);">
                                                            None
                                                        </button>
                                                        <button id="btLevelFull" type="button" class="btn btn-default" style="min-width: 120px" onclick="toggleDisplayLevelEnabled(this.id);">
                                                            Full
                                                        </button>
                                                    </div>
                                                </div>


                                                <br />
                                                <div>
                                                    <label>AcceptEULA</label>
                                                </div>
                                                <div>
                                                    <div class="btn-group" style="width:300px">

                                                        <button id="btAcceptEULAEnabled" type="button" class="btn btn-default" style="min-width: 120px" onclick="toggleDisplayEULAEnabled(this.id);">
                                                            True
                                                        </button>
                                                        <button id="btAcceptEULADisabled" type="button" class="btn btn-default" style="min-width: 120px" onclick="toggleDisplayEULAEnabled(this.id);">
                                                            False
                                                        </button>
                                                    </div>
                                                </div>


                                                <br />

                                                <div class="control-group">
                                                    <label></label>
                                                    <div class="controls">
                                                        <button id="btSaveDisplay" class="btn btn-primary">
                                                            Save
                                                        </button>
                                                        <button id="btRemoveDisplay" class="btn btn-primary">
                                                            Remove
                                                        </button>
                                                    </div>
                                                </div>
                                            </form>
                                        </div>

                                        <!--/panel content-->
                                    </div>

                                </div>

                                <!-- Logging-->
                                <div class="tab-pane well" id="logging">

                                    <div class="panel panel-default">
                                        <div class="panel-heading">
                                            <div class="panel-title">
                                                <h4>Logging</h4>
                                            </div>
                                        </div>

                                        <div class="panel-body">
                                            <form class="form form-vertical">

                                               <div>
                                                    <label>Level</label>
                                                </div>
                                                <div>
                                                    <div class="btn-group" style="width:300px">

                                                        <button id="btLoggingLevelOff" type="button" class="btn btn-default" style="min-width: 120px" onclick="toggleLoggingEnabled(this.id);">
                                                            Off
                                                        </button>
                                                        <button id="btLoggingLevelStandard" type="button" class="btn btn-default" style="min-width: 120px" onclick="toggleLoggingEnabled(this.id);">
                                                            Standard
                                                        </button>
                                                    </div>
                                                </div>

                                                <br />

                                                <div class="control-group">
                                                    <label>Path</label>
                                                    <div class="controls">
                                                        <input id="txtLoggingUpdatePath" type="text" class="form-control" placeholder="">
                                                    </div>
                                                </div>

                                                <br />

                                                <div class="control-group">
                                                    <label></label>
                                                    <div class="controls">
                                                        <button id="btSaveLogging" class="btn btn-primary">
                                                            Save
                                                        </button>
                                                        <button id="btRemoveLogging" class="btn btn-primary">
                                                            Remove
                                                        </button>
                                                    </div>
                                                </div>
                                            </form>
                                        </div>

                                        <!--/panel content-->
                                    </div>

                                </div>

                            </div>

                        </div>
                        <!--/tabs-->
                    </div>

                    <div class="col-md-7" style="min-width: 550px;padding-right: 40px">
                        <div class="panel panel-default" id="xmlViewerPane">
                            <div class="panel-heading">
                                <table style="width: 100%">
                                    <tr>
                                        <td style="width: 200px;text-wrap:none;">
                                            <h4>XML Viewer</h4>
                                        </td>

                                        <td style="padding-right:10px;text-align: right">
                                            <form id="text-options">
                                                <input type="button" class="btn btn-default btn-primary" value="Upload" onclick="document.getElementById('fileInput').click();">
                                            </form>
                                        </td>

                                        <td style="padding-right:10px;width: 100px;text-align: right">
                                            <form id="text-options">
                                                <input type="button" class="btn btn-default btn-primary" value="Download" onclick="download()">
                                            </form>
                                        </td>

                                        <td style="width:200px;display: none;width: 100px;">
                                            <input type="file" id="fileInput" size="10">
                                        </td>

                                    </tr>
                                </table>


                            </div>
                            <div class="panel-body">
                                <textarea id="xmlText" style="width:100%; min-height: 455px;font-size:20px" rows="3" placeholder=""></textarea>
                            </div>

                        </div>
                    </div>
                    

                    <!-- Product Modal -->
                    <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                                    <h4 class="modal-title" id="myModalLabel">Help</h4>
                                </div>
                                <div class="modal-body">
                                    <h4>Office Product</h4>
                                    <p>Specifies the Click-to-Run product to install.</p>
                                    <hr>
                                    <p>Required. <strong>ID</strong> must be set to a valid ProductRelease ID.</p> <p>The supported ProductRelease IDs for Click-to-Run for Office 365 products are as follows:</p> <ul><li> <p>O365ProPlusRetail</p> </li> <li> <p>O365BusinessRetail</p> </li>  <li> <p>VisioProRetail</p> </li><li> <p>ProjectProRetail</p> </li><li> <p>SPDRetail (SharePoint Designer)</p> </li></ul> <p>If <strong>ID</strong> is not set, the operation fails and indicates that the input is not valid.</p> <p>The order of <strong>Product</strong> elements determines the order in which the products are installed. The first <strong>Product ID</strong> is used to determine in which context the Microsoft Office First Run Experience application starts. Microsoft Office First Run Experience refers to the first time each Office application starts.</p>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Bitness Modal -->
                    <div class="modal fade" id="bitnessModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                                    <h4 class="modal-title" id="myModalLabel">Help</h4>
                                </div>
                                <div class="modal-body">
                                    <h4>Office Client Edition</h4>
                                    <p>Specifies the edition of Click-to-Run for Office 365 product to use: 32- or 64-bit.</p>
                                    <hr>
                                    <p>Required. Specifies the edition of Click-to-Run for Office 365 product to use: 32- or 64-bit. The action fails if <strong>OfficeClientEdition</strong> is not set to a valid value.</p> <p>A <strong>configure</strong> mode action may fail if <strong>OfficeClientEdition</strong> is set incorrectly. For example, if you attempt to install a 64-bit edition of a Click-to-Run for Office 365 product on a computer that is running a 32-bit Windows operating system, or if you try to install a 32-bit Click-to-Run for Office 365 product on a computer that has a 64-bit edition of Office installed.</p>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Language Modal -->
                    <div class="modal fade" id="languageModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                                    <h4 class="modal-title" id="myModalLabel">Help</h4>
                                </div>
                                <div class="modal-body">
                                    <h4>Product Language</h4>
                                    <p>Determine which product languages to install.</p>
                                    <hr>
                                    <p>Required. If the <strong>Language ID</strong> value is not set, the installation operation fails and indicates that the input is not valid.</p> <p>The <strong>ID</strong> value can be set to a valid Office culture language (such as en-us for English US or ja-jp for Japanese). The <em>ll-cc</em> value is the language identifier. </p>
                                    
                                    <div class="alert">
                                        <table>
                                            <tr><th align="left"><img id="note" alt="Note" src="https://i-technet.sec.s-msft.com/areas/global/content/clear.gif" title="Note" xmlns="" class="cl_IC101471" /><strong>Note: </strong></th></tr>
                                            <tr>
                                                <td>
                                                    Language elements determine which product languages to install. Administrators must specify the languages they want to install. The first language determines the Shell UI culture. The Shell UI is the language of shortcuts, right-click context menus, and tooltips.<br />
                                                    If you decide that you want to change the Shell UI language after an initial installation, you have to uninstall Click-to-Run and reinstall. Add the language that you want to set for the Shell UI as the first language in the custom Configuration.xml file.
                                                </td>
                                            </tr>
                                        </table>
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Version Modal -->
                    <div class="modal fade" id="versionModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                                    <h4 class="modal-title" id="myModalLabel">Help</h4>
                                </div>
                                <div class="modal-body">
                                    <h4>Product Version</h4>
                                    <p>The Version of the Click-to-Run product to installation</p>
                                    <hr>
                                    <p>Optional. If a <strong>Version</strong> value is not set, the Click-to-Run product installation streams the latest available version from the source. The default is to use the most recently advertised build (as defined in v32.CAB or v64.CAB at the Click-to-Run Office installation source). </p> <p> <strong>Version</strong> can be set to an Office 2013 build number by using this format: X.X.X.X</p>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- SourcePath Modal -->
                    <div class="modal fade" id="sourcepathModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                                    <h4 class="modal-title" id="myModalLabel">Help</h4>
                                </div>
                                <div class="modal-body">
                                    <h4>Source Path</h4>
                                    <p>Indicates the location to save the Click-to-Run installation source when you run the Office Deployment Tool in download mode.</p>
                                    <hr>
                                    <p>Optional. </p> <p>The <strong>SourcePath</strong> value can be set to a network, local, or HTTP path that contains a Click-to-Run source. Environment variables can be used for network or local paths.</p> <p></p> <p> <strong>SourcePath</strong> indicates the location to save the Click-to-Run installation source when you run the Office Deployment Tool in <strong>download</strong> mode. </p> <p></p> <p> <strong>SourcePath</strong> indicates the installation source path from which to install Office when you run the Office Deployment Tool in <strong>configure</strong> mode. If you don’t specify <strong>SourcePath</strong> in <strong>configure</strong> mode, Setup will look in the current folder for the Office source files. If the Office source files aren’t found in the current folder, Setup will look on Office 365 for them.</p> <p></p> <p> <strong>SourcePath</strong> specifies the path of the Click-to-Run Office source from which the App-V package will be made when you run the Office Deployment Tool in <strong>packager</strong> mode.</p> <p>If you do not specify <strong>SourcePath</strong>, Setup will attempt to create an <strong>\Office\Data\...</strong> folder structure in the working directory from which you are running setup.exe.</p>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- PIDKEY Modal -->
                    <div class="modal fade" id="pidkeyModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                                    <h4 class="modal-title" id="myModalLabel">Help</h4>
                                </div>
                                <div class="modal-body">
                                    <h4>PIDKEY</h4>
                                    <p>The 25-character volume license key.</p>
                                    <hr>
                                    <p>Optional. </p> 
                                    
                                    <p>When the <strong>PIDKEY</strong> value is set, users are not required to enter a product key when they install Office.</p>
                                    
                                    <p>If this element is not defined, the default settings are used. If an invalid value is specified, Setup ends the installation. </p> <p>If the <strong>Level</strong> attribute is set to "basic" or “none” and you supply a product key by using the <a href="#ElementPIDKEY">PIDKEY</a>, Setup assumes that you also accept the license agreement on behalf of the user.</p></div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- ExcludeApp Modal -->
                    <div class="modal fade" id="excludeappModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                                    <h4 class="modal-title" id="myModalLabel">Help</h4>
                                </div>
                                <div class="modal-body">
                                    <h4>ExcludeApp</h4>
                                    <p>Specifies which Office programs not to install.</p>
                                    <hr>
                                    <p>Optional. </p>
                                    <p>The following is a list of the supported values for <strong>ID</strong>:</p> <ul><li> <p>Access</p> </li><li> <p>Excel</p> </li><li> <p>Groove</p> </li><li> <p>InfoPath</p> </li><li> <p>Lync</p> </li><li> <p>OneNote</p> </li><li> <p>Outlook</p> </li><li> <p>PowerPoint</p> </li><li> <p>Project</p> </li><li> <p>Publisher</p> </li><li> <p>SharePointDesigner</p> </li><li> <p>Visio</p> </li><li> <p>Word</p> </li></ul> <p>The value “Groove” is used to exclude OneDrive for Business.</p> <p>The value "Lync" also applies to Skype for Business.</p> </td> </tr> </table> <p>The following example shows how to install the 32-bit edition of Office 365 ProPlus in English, without Access or InfoPath.</p>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- RemoveProducts Modal -->
                    <div class="modal fade" id="removeproductsModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                                    <h4 class="modal-title" id="myModalLabel">Help</h4>
                                </div>
                                <div class="modal-body">
                                    <h4>Remove Products</h4>
                                    <p>Removes products and languages.</p>
                                    <hr>
                                    
                                    
                                    <div id="DIV_1">
                                        <table id="TABLE_2">
                                            <tbody id="TBODY_3">
                                                <tr id="TR_4">
                                                    <th id="TH_5">
                                                        <img id="IMG_6" alt="Important" src="https://i-technet.sec.s-msft.com/areas/global/content/clear.gif" /><strong id="STRONG_7">Important:</strong>
                                                    </th>
                                                </tr>
                                                <tr id="TR_8">
                                                    <td id="TD_9">
                                                        To remove an installed language for a product, you must specify the ID for the product, and specify the ID for the language that you want to remove. To remove a product completely, you must specify the ID for the product, and specify the IDs of all the languages that are installed. But, if the product and languages are also specified in the <a href="#BKMK_AddElement" id="A_10">Add element</a> of the configuration.xml file, then the product or languages won’t be removed.<br id="BR_11" /> If <strong id="STRONG_12">All</strong> is set to <strong id="STRONG_13">TRUE</strong>, then all products and languages are removed, regardless of what is specified in the <a href="#BKMK_AddElement" id="A_14">Add element</a>.
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                    
                                    

                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- UpdatePath Modal -->
                    <div class="modal fade" id="updatepathModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                                    <h4 class="modal-title" id="myModalLabel">Help</h4>
                                </div>
                                <div class="modal-body">
                                    <h4>Update Path</h4>
                                    <p>Specifies a network, local, or HTTP path of a Click-to-Run source.</p>
                                    <hr>
                                    Optional. 
                                    <br/>
                                    <br />
                                    If <strong id="STRONG_3">UpdatePath</strong> is not set, Click-to-Run installations obtain updates from the Microsoft Click-to-Run source (Content Delivery Network or CDN). This is by default. If <strong id="STRONG_5">UpdatePath</strong> is set to empty (""), updates are obtained from the Microsoft Click-to-Run source, CDN. <strong id="STRONG_7">UpdatePath</strong> can specify a network, local, or HTTP path of a Click-to-Run source. Environment variables can be used for network or local paths. If you use Group Policy and the <a href="http://go.microsoft.com/fwlink/p/?LinkID=257051" id="A_10">Office 2013 Administrative Template files (ADMX/ADML)</a>, you can set <strong id="STRONG_11">UpdatePath</strong> by using the <strong id="STRONG_12">Update Path</strong> policy setting. You can find this policy setting under Computer Configuration\Administrative Templates\Microsoft Office 2013 (Machine)\Updates.
                                   
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- TargetVersion Modal -->
                    <div class="modal fade" id="targetversionModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                                    <h4 class="modal-title" id="myModalLabel">Help</h4>
                                </div>
                                <div class="modal-body">
                                    <h4>Target Version</h4>
                                    <p>The Click-to-Run product version to install.</p>
                                    <hr>
                                    Optional.
                                    <br />
                                    <br />
                                    
                                    If <strong id="STRONG_3">TargetVersion</strong> is not set, Click-to-Run updates to the most recent version from the Microsoft Click-to-Run source. If <strong id="STRONG_5">TargetVersion</strong> is set to empty (""), Click-to-Run updates to the latest version from the Microsoft Click-to-Run source. <strong id="STRONG_7">TargetVersion</strong> can be set to an Office build number, for example, 15.1.2.3. When the version is set, Office attempts to transition to the specified version in the next update cycle. If you use Group Policy and the <a href="http://go.microsoft.com/fwlink/p/?LinkID=257051" id="A_9">Office 2013 Administrative Template files (ADMX/ADML)</a>, you can set <strong id="STRONG_10">TargetVersion</strong> by using the <strong id="STRONG_11">Target Version</strong> policy setting. You can find this policy setting under Computer Configuration\Administrative Templates\Microsoft Office 2013 (Machine)\Updates.
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Deadline Modal -->
                    <div class="modal fade" id="deadlineModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                                    <h4 class="modal-title" id="myModalLabel">Help</h4>
                                </div>
                                <div class="modal-body">
                                    <h4>Deadline</h4>
                                    <p>Sets a deadline by when updates to Office must be applied. The deadline is specified in Coordinated Universal Time (UTC).</p>
                                    <hr>
                                    Optional.
                                    <br />
                                    <br />
                                    
                                    Sets a deadline by when updates to Office must be applied. The deadline is specified in Coordinated Universal Time (UTC). You can use <strong id="STRONG_4">Deadline</strong> with <strong id="STRONG_5">Target Version</strong> to make sure that Office is updated to a particular version by a particular date. We recommend that you set the deadline at least a week in the future to allow users time to install the updates. Prior to the deadline, users receive multiple reminders to install the updates. If Office isn’t updated by the deadline, users see a notification that the updates will be applied in 15 minutes. This gives users the opportunity to save the Office documents that they are working on and to close any Office programs that are open. If users don’t close the Office programs, the programs are closed automatically when the 15 minutes are up, which might result in data loss. After the Office programs are closed, the updates are applied automatically. The deadline only applies to one set of updates. If you want to use a deadline to make sure that Office is always up-to-date, you must change the deadline every time that a new update for Office is available. To use this attribute, Office must be running at least Service Pack 1 (version 15.0.4569.1507) and you must use at least version 15.0.4595.1000 of the Office Deployment Tool. If you use Group Policy and the <a href="http://go.microsoft.com/fwlink/p/?LinkID=257051" id="A_10">Office 2013 Administrative Template files (ADMX/ADML)</a>, you can set <strong id="STRONG_11">Deadline</strong> by using the <strong id="STRONG_12">Update Deadline</strong> policy setting. You can find this policy setting under Computer Configuration\Administrative Templates\Microsoft Office 2013 (Machine)\Updates.
                                    
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                                </div>
                            </div>
                        </div>
                    </div>



                </div>
            </div>

        </div>
    </div>


    <!--<script type='text/javascript' src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
        <script type='text/javascript' src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>-->
    
    <script type="text/javascript" src="/scripts/jquery-1.9.1.min.js"></script>
    <script type="text/javascript" src="/Scripts/FileSaver.js"></script>
    <script type="text/javascript" src="/scripts/moment.min.js"></script>
    <script type="text/javascript" src="/scripts/bootstrap.min.js"></script>
    <script type="text/javascript" src="/scripts/bootstrap-datetimepicker.js"></script>
    

    <!-- JavaScript jQuery code from Bootply.com editor  -->

    <script type='text/javascript'>

        $(document).ready(function () {

            //$('#datetimepicker1').datetimepicker();
            //$('#txtDeadline').datetimepicker({
            //    sideBySide: true
            //}).on("dp.change", function (e) {
            //    var date = e.date; //e.date is a moment object
            //    selectDate = date.format("MM/DD/YYYY HH:mm");
            //    var target = $(e.target).attr('name');
            //});

            var fileInput = document.getElementById('fileInput');
            $("#btRemoveProduct").prop("disabled", true);
            $("#btAddLanguage").prop("disabled", true);
            $("#btRemoveLanguage").prop("disabled", true);

            $("#collapseOne").collapse('hide');
            $("#toggleExpand").removeClass('glyphicon-collapse-up');
            $("#toggleExpand").addClass('glyphicon-collapse-down');

            fileInput.addEventListener('change', function (e) {
                // Put the rest of the demo code here.

                var control = document.getElementById('fileInput');

                var i = 0,
                files = control.files;
                var file = files[i];

                var reader = new FileReader();

                reader.onload = function (event) {
                    var contents = event.target.result;
                    var xmlOutput = vkbeautify.xml(contents);
                    $('textarea#xmlText').val(xmlOutput);

                    loadUploadXmlFile();
                };

                reader.onerror = function (event) {
                    throw "File could not be read! Code " + event.target.error.code;
                };

                reader.readAsText(file);
            });

            resizeWindow();

            $(window).resize(function () {
                resizeWindow();
            });

            //$(".alert").addClass("in").fadeOut(4500);

            $('#txtPidKey').keyup(function () {

                validatePidKey(this);

            });

            /* swap open/close side menu icons */
            $('[data-toggle=collapse]').click(function () {
                // toggle icon
                $(this).find("i").toggleClass("glyphicon-chevron-right glyphicon-chevron-down");
            });

            $("#btAddProduct").button().click(function () {
                var xmlDoc = getXmlDocument();

                odtAddProduct(xmlDoc);

                displayXml(xmlDoc);

                $("#btAddProduct").text('Edit Product');

                return false;
            });

            $("#btRemoveProduct").button().click(function () {
                var xmlDoc = getXmlDocument();

                odtRemoveProduct(xmlDoc);

                displayXml(xmlDoc);

                return false;
            });

            $("#btAddLanguage").button().click(function () {
                var xmlDoc = getXmlDocument();

                odtAddLanguage(xmlDoc);

                displayXml(xmlDoc);
                return false;
            });

            $("#btRemoveLanguage").button().click(function () {
                var xmlDoc = getXmlDocument();

                odtRemoveLanguage(xmlDoc);

                displayXml(xmlDoc);
                return false;
            });

            $("#cbProduct").change(function () {
                var end = this.value;
                changeSelectedProduct();
            });

            $("#cbLanguage").change(function () {
                var end = this.value;
                changeSelectedLanguage();
            });

            $("#btAddExcludeApp").button().click(function () {
                var xmlDoc = getXmlDocument();

                odtAddExcludeApp(xmlDoc);

                displayXml(xmlDoc);
                return false;
            });

            $("#btRemoveExcludeApp").button().click(function () {
                var xmlDoc = getXmlDocument();

                odtRemoveExcludeApp(xmlDoc);

                displayXml(xmlDoc);
                return false;
            });

            $("#btAddRemoveProduct").button().click(function () {
                var xmlDoc = getXmlDocument();

                odtAddRemoveApp(xmlDoc);

                displayXml(xmlDoc);
                return false;
            });

            $("#btAddRemoveLanguage").button().click(function () {
                var xmlDoc = getXmlDocument();

                odtAddRemoveLanguage(xmlDoc);

                displayXml(xmlDoc);
                return false;
            });

            $("#btRemoveRemoveLanguage").button().click(function () {
                var xmlDoc = getXmlDocument();

                odtRemoveRemoveLanguage(xmlDoc);

                displayXml(xmlDoc);
                return false;
            });

            $("#btSaveUpdates").button().click(function () {
                var xmlDoc = getXmlDocument();

                odtSaveUpdates(xmlDoc);

                displayXml(xmlDoc);
                return false;
            });

            $("#btRemovesUpdates").button().click(function () {
                var xmlDoc = getXmlDocument();

                odtRemoveUpdates(xmlDoc);

                displayXml(xmlDoc);
                return false;
            });

            $("#btSaveDisplay").button().click(function () {
                var xmlDoc = getXmlDocument();

                odtSaveDisplay(xmlDoc);

                displayXml(xmlDoc);
                return false;
            });

            $("#btRemoveDisplay").button().click(function () {
                var xmlDoc = getXmlDocument();

                odtRemoveDisplay(xmlDoc);

                displayXml(xmlDoc);
                return false;
            });

            $("#btSaveLogging").button().click(function () {
                var xmlDoc = getXmlDocument();

                odtSaveLogging(xmlDoc);

                displayXml(xmlDoc);
                return false;
            });

            $("#btRemoveLogging").button().click(function () {
                var xmlDoc = getXmlDocument();

                odtRemoveLogging(xmlDoc);

                displayXml(xmlDoc);
                return false;
            });

        });

        function toggleExpandOptional(source) {

            if ($("#toggleExpand").hasClass('glyphicon-collapse-up')) {
                $("#toggleExpand").removeClass('glyphicon-collapse-up');
                $("#toggleExpand").addClass('glyphicon-collapse-down');
            } else {
                $("#toggleExpand").addClass('glyphicon-collapse-up');
                $("#toggleExpand").removeClass('glyphicon-collapse-down');
            }

        }

        function download() {
            var xmlDoc = getXmlDocument();
            var xmlString = (new XMLSerializer().serializeToString(xmlDoc.documentElement));
            var xmlOutput = vkbeautify.xml(xmlString);

            xmlOutput = xmlOutput.replace(/\n/g, "\r\n");

            var blob = new Blob([xmlOutput], { type: "text/xml" });
            saveAs(blob, "configuration.xml");
        }

        function validatePidKey(t) {
            //if (!this.value.match(/[0-9]/)) {
            //    this.value = this.value.replace(/[^0-9]/g, '');
            //}

            var currentText = t.value;
            if (currentText.length > 5) {

                var firstPart = "";
                var secondPart = "";

                var dash1 = currentText.substring(5, 6);
                if (dash1 != "-") {
                    var firstPart = currentText.substring(0, 5);
                    var restPart = currentText.substring(5, currentText.length);

                    firstPart = firstPart + "-" + restPart;
                    t.value = firstPart;
                }

                var dash2 = currentText.substring(10, 11);
                if (dash2 != "-") {
                    var firstPart2 = currentText.substring(10, 15);
                    var restPart2 = currentText.substring(10, currentText.length);

                    secondPart = firstPart2 + "-" + restPart2;
                    t.value = firstPart + secondPart;
                }
            }
        }

        function changeSelectedLanguage() {
            var selectedProduct = $("#cbProduct").val();
            var selectLanguage = $("#cbLanguage").val();

            var xmlDoc = getXmlDocument();
            
            $("#btAddLanguage").prop("disabled", false);

            var addNode = null;
            var nodes = xmlDoc.documentElement.getElementsByTagName("Add");
            if (nodes.length > 0) {
                addNode = xmlDoc.documentElement.getElementsByTagName("Add")[0];
            }

            if (addNode) {
                var productNode = getProductNode(addNode, selectedProduct);

                var langNode = getLanguageNode(productNode, selectLanguage);
                if (langNode) {
                    $("#btAddLanguage").prop("disabled", true);
                }
            }
        }

        function changeSelectedProduct() {
            var productId = $('#cbProduct').val();

            var xmlDoc = getXmlDocument();

            $("#txtPidKey").val("");

            var productCount = getAddProductCount(xmlDoc);
            if (productCount > 0) {
                var productNode = getProductNode(xmlDoc, productId);
                if (productNode) {
                    $("#btAddProduct").text('Edit Product');
                    $("#btRemoveProduct").prop("disabled", false);

                    var pidKey = productNode.getAttribute("PIDKEY");
                    if (pidKey) {
                        $("#txtPidKey").val(pidKey);
                    }

                    var excludeApps = productNode.getElementsByTagName("ExcludeApp");
                    if (excludeApps.length == 0) {
                        $("#btRemoveExcludeApp").prop("disabled", true);
                        $("select#cbExcludeApp").prop('selectedIndex', 0);
                    } else {
                        $("#btRemoveExcludeApp").prop("disabled", false);

                        var excludeApp = excludeApps[0];
                        if (excludeApp) {
                            $("#cbExcludeApp").val(excludeApp.getAttribute("ID"));
                        }
                    }

                } else {
                    $("#btAddProduct").text('Add Product');
                    //$("#btRemoveProduct").prop("disabled", true);
                    $("#btRemoveExcludeApp").prop("disabled", true);
                    $("select#cbExcludeApp").prop('selectedIndex', 0);
                }
            } else {
                $("#btRemoveProduct").prop("disabled", true);
            }

            var langCount = getLanguageNodeCount(xmlDoc, productId);
            $("#btRemoveLanguage").prop("disabled", !(langCount > 1));
        }

        function loadUploadXmlFile() {
            var xmlDoc = getXmlDocument();

            var addNode = null;
            var nodes = xmlDoc.documentElement.getElementsByTagName("Add");
            if (nodes.length > 0) {
                addNode = xmlDoc.documentElement.getElementsByTagName("Add")[0];

                var selectBitness = addNode.getAttribute("OfficeClientEdition");
                $("#cbEdition").val(selectBitness);

                var products = addNode.getElementsByTagName("Product");
                if (products.length > 0) {
                    var product = products[0];
                    var productId = product.getAttribute("ID");

                    $("#cbProduct").val(productId);

                    var pidKey = product.getAttribute("PIDKEY");
                    $("#txtPidKey").val(pidKey);

                    var exApps = product.getElementsByTagName("ExcludeApp");
                    if (exApps.length > 0) {
                        var exApp = exApps[0];
                        var excludeAppId = exApp.getAttribute("ID");
                        $("#cbExcludeApp").val(excludeAppId);

                        $("#btRemoveExcludeApp").prop("disabled", false);
                    } else {
                        $("#btRemoveExcludeApp").prop("disabled", true);
                    }
                }

                var version = addNode.getAttribute("Version");
                $("#txtVersion").val(version);

                var version = addNode.getAttribute("SourcePath");
                $("#txtSourcePath").val(version);
            }

            var removeNode = null;
            var remvoeNodes = xmlDoc.documentElement.getElementsByTagName("Remove");
            if (remvoeNodes.length > 0) {
                removeNode = xmlDoc.documentElement.getElementsByTagName("Remove")[0];
                if (removeNode) {
                    var removeProducts = removeNode.getElementsByTagName("Product");
                    if (removeProducts.length > 0) {
                        var removeproduct = removeProducts[0];
                        var removeproductId = removeproduct.getAttribute("ID");

                        $("#cbRemoveProduct").val(removeproductId);

                        var removeLangs = removeproduct.getElementsByTagName("Language");
                        if (removeLangs.length > 0) {
                            var removeLangId = removeLangs[0].getAttribute("ID");
                            $("#cbRemoveLanguage").val(removeLangId);
                        }

                        toggleRemove("removeSelectProducts");
                    } else {
                        toggleRemove("removeallproducts");
                    }
                }
            }

            var updateNodes = xmlDoc.documentElement.getElementsByTagName("Update");
            if (updateNodes.length > 0) {
                var updateNode = xmlDoc.documentElement.getElementsByTagName("Update")[0];

                var updatesEnabled = updateNode.getAttribute("Enabled");
                var selectUpdatePath = updateNode.getAttribute("UpdatePath");
                var selectTargetVersion = updateNode.getAttribute("TargetVersion");
                var selectDeadline = updateNode.getAttribute("Deadline");

                if (updatesEnabled == "TRUE") {
                    toggleUpdatesEnabled("btupdatesEnabled");
                    $("#txtUpdatePath").val(selectUpdatePath);
                    $("#txtTargetVersion").val(selectTargetVersion);
                    $("#txtDeadline").val(selectDeadline);
                } else {
                    toggleUpdatesEnabled("btupdatesDisabled");
                    $("#txtUpdatePath").val("");
                    $("#txtTargetVersion").val("");
                    $("#txtDeadline").val("");
                }
            }

            var displayNodes = xmlDoc.documentElement.getElementsByTagName("Display");
            if (displayNodes.length > 0) {
                var displayNode = xmlDoc.documentElement.getElementsByTagName("Display")[0];

                var logLevel = displayNode.getAttribute("Level");
                var acceptEula = displayNode.getAttribute("AcceptEULA");

                if (logLevel == "None") {
                    toggleDisplayLevelEnabled("btLevelNone");
                } else {
                    toggleDisplayLevelEnabled("btLevelFull");
                }

                if (acceptEula == "TRUE") {
                    toggleDisplayEULAEnabled("btAcceptEULAEnabled");
                } else {
                    toggleDisplayEULAEnabled("btAcceptEULADisabled");
                }
            }

            var loggingNodes = xmlDoc.documentElement.getElementsByTagName("Logging");
            if (loggingNodes.length > 0) {
                var loggingNode = xmlDoc.documentElement.getElementsByTagName("Logging")[0];

                var logLevel = loggingNode.getAttribute("Level");
                var path = loggingNode.getAttribute("Path");

                if (logLevel == "Off") {
                    toggleLoggingEnabled("btLoggingLevelOff");
                } else {
                    toggleLoggingEnabled("btLoggingLevelStandard");
                }

                $("#txtLoggingUpdatePath").val(path);
            }

            var productCount = getAddProductCount(xmlDoc);
            if (productCount == 0) {
                $("#btRemoveProduct").prop("disabled", true);
            } else {
                $("#btRemoveProduct").prop("disabled", false);
            }

        }

        function resizeWindow() {
            var bodyHeight = window.innerHeight;
            var bodyWidth = window.innerWidth;
            var leftPaneHeight = bodyHeight - 180;

            //$("#mainDiv").height(bodyHeight - 70);

            //$("#removeproduct").height(leftPaneHeight);
            //$("#profile").height(leftPaneHeight);
            //$("#updates").height(leftPaneHeight);
            //$("#display").height(leftPaneHeight);
            //$("#logging").height(leftPaneHeight);

            var rightPaneHeight = bodyHeight - 100;
            $("#xmlText").height(rightPaneHeight - 100);

        }

        function getXmlDocument() {
            var xmlSource = $('textarea#xmlText').val();
            if (!(xmlSource)) {
                xmlSource = "<Configuration></Configuration>";
            }
            var xmlDoc = createXmlDocument(xmlSource);
            return xmlDoc;
        }


        function odtAddLanguage(xmlDoc) {
            var selectedProduct = $("#cbProduct").val();
            var selectLanguage = $("#cbLanguage").val();

            var addNode = xmlDoc.createElement("Add");

            var nodes = xmlDoc.documentElement.getElementsByTagName("Add");
            if (nodes.length > 0) {
                addNode = xmlDoc.documentElement.getElementsByTagName("Add")[0];

                var productNode = getProductNode(addNode, selectedProduct);
                if (productNode) {
                    var langNode = getLanguageNode(productNode, selectLanguage);
                    if (!(langNode)) {

                        var langs = productNode.getElementsByTagName("Language");
                        var lastLang = langs[langs.length - 1];

                        var langList = [];
                        for (var p = 0; p < langs.length; p++) {
                            var langChkNode1 = langs[p];
                            langList.push(langChkNode1);
                        }

                        for (var l = 0; l < langs.length; l++) {
                            var langChkNode2 = langs[l];
                            productNode.removeChild(langChkNode2);
                        }

                        for (var t = 0; t < langList.length ; t++) {
                            var langChkNode = langList[t];
                            productNode.appendChild(langChkNode);
                        }

                        langNode = xmlDoc.createElement("Language");
                        langNode.setAttribute("ID", selectLanguage);
                        productNode.appendChild(langNode, lastLang);

                        $("#btAddLanguage").prop("disabled", true);
                    }
                }
            }

            var langCount = getLanguageNodeCount(xmlDoc, selectedProduct);
            $("#btRemoveLanguage").prop("disabled", !(langCount > 1));
        }

        function odtRemoveLanguage(xmlDoc) {
            var selectedProduct = $("#cbProduct").val();
            var selectLanguage = $("#cbLanguage").val();

            var addNode = null;

            var nodes = xmlDoc.documentElement.getElementsByTagName("Add");
            if (nodes.length > 0) {
                addNode = xmlDoc.documentElement.getElementsByTagName("Add")[0];

                var productNode = getProductNode(addNode, selectedProduct);
                if (productNode) {
                    if (getLanguageNodeCount(xmlDoc, selectedProduct) > 1) {
                        var langNode = getLanguageNode(productNode, selectLanguage);
                        if (langNode) {
                            productNode.removeChild(langNode);
                            $("#btAddLanguage").prop("disabled", false);
                        }
                    }
                }
            }

            var langCount = getLanguageNodeCount(xmlDoc, selectedProduct);
            $("#btRemoveLanguage").prop("disabled", !(langCount > 1));
        }


        function odtAddRemoveLanguage(xmlDoc) {
            var selectedProduct = $("#cbRemoveProduct").val();
            var selectLanguage = $("#cbRemoveLanguage").val();

            var removeNode = xmlDoc.createElement("Remove");

            var nodes = xmlDoc.documentElement.getElementsByTagName("Remove");
            if (nodes.length > 0) {
                removeNode = xmlDoc.documentElement.getElementsByTagName("Remove")[0];

                var productNode = getProductNode(removeNode, selectedProduct);
                if (productNode) {
                    var langNode = getLanguageNode(productNode, selectLanguage);
                    if (!(langNode)) {

                        var langs = productNode.getElementsByTagName("Language");
                        var lastLang = langs[langs.length - 1];

                        langNode = xmlDoc.createElement("Language");
                        langNode.setAttribute("ID", selectLanguage);
                        productNode.insertBefore(langNode, lastLang);
                    }
                }
            }

            var langCount = getRemoveLanguageNodeCount(xmlDoc, selectedProduct);
            $("#btRemoveRemoveLanguage").prop("disabled", !(langCount > 1));
        }

        function odtRemoveRemoveLanguage(xmlDoc) {
            var selectedProduct = $("#cbRemoveProduct").val();
            var selectLanguage = $("#cbRemoveLanguage").val();

            var removeNode = null;

            var nodes = xmlDoc.documentElement.getElementsByTagName("Remove");
            if (nodes.length > 0) {
                removeNode = xmlDoc.documentElement.getElementsByTagName("Remove")[0];

                var productNode = getProductNode(removeNode, selectedProduct);
                if (productNode) {
                    if (getRemoveLanguageNodeCount(xmlDoc, selectedProduct) > 1) {
                        var langNode = getLanguageNode(productNode, selectLanguage);
                        if (langNode) {
                            productNode.removeChild(langNode);
                        }
                    }
                }
            }

            var langCount = getRemoveLanguageNodeCount(xmlDoc, selectedProduct);
            $("#btRemoveLanguage").prop("disabled", !(langCount > 1));
        }



        function odtAddRemoveApp(xmlDoc) {
            var selectedProduct = $("#cbRemoveProduct").val();
            var selectLanguage = $("#cbRemoveLanguage").val();

            var removeNode = xmlDoc.createElement("Remove");
            var nodes = xmlDoc.documentElement.getElementsByTagName("Remove");
            if (nodes.length > 0) {
                removeNode = xmlDoc.documentElement.getElementsByTagName("Remove")[0];
            } else {
                xmlDoc.documentElement.appendChild(removeNode);
            }

            var $removeSelect = $("#removeSelectProducts");
            if ($removeSelect.hasClass('btn-primary')) {
                removeNode.removeAttribute("ALL");

                var productNode = getProductNode(removeNode, selectedProduct);
                if (!(productNode)) {
                    productNode = xmlDoc.createElement("Product");
                    productNode.setAttribute("ID", selectedProduct);
                    removeNode.appendChild(productNode);
                }

                var langNode = getLanguageNode(productNode, selectLanguage);
                if (!(langNode)) {
                    langNode = xmlDoc.createElement("Language");
                    langNode.setAttribute("ID", selectLanguage);
                    productNode.appendChild(langNode);
                }
            } else {
                removeNode.setAttribute("ALL", "TRUE");
                if (removeNode.childElementCount > 0) {
                    var products = removeNode.getElementsByTagName("Product");
                    for (var v = 0; v < products.length; v++) {
                        removeNode.removeChild(products[v]);
                    }
                }
            }

            var addNode = null;
            var addNodes = xmlDoc.documentElement.getElementsByTagName("Add");
            if (addNodes.length > 0) {
                addNode = xmlDoc.documentElement.getElementsByTagName("Add")[0];
            }

            if (addNode) {
                var existingAddProduct = checkForAddProductNode(xmlDoc, selectedProduct);
                if (existingAddProduct) {
                    addNode.removeChild(existingAddProduct);
                }

                if (addNode.childElementCount == 0) {
                    xmlDoc.documentElement.removeChild(addNode);
                }
            }

        }


        function odtAddExcludeApp(xmlDoc) {
            var selectedProduct = $("#cbProduct").val();
            var selectExcludeApp = $("#cbExcludeApp").val();

            var addNode = null;

            var nodes = xmlDoc.documentElement.getElementsByTagName("Add");
            if (nodes.length > 0) {
                addNode = xmlDoc.documentElement.getElementsByTagName("Add")[0];

                var productNode = getProductNode(addNode, selectedProduct);
                if (productNode) {
                    var exNode = getExcludeAppNode(productNode, selectExcludeApp);
                    if (!(exNode)) {
                        var excludeApps = productNode.getElementsByTagName("ExcludeApp");
                        var excludeNode = excludeApps[excludeApps.length - 1];

                        exNode = xmlDoc.createElement("ExcludeApp");
                        exNode.setAttribute("ID", selectExcludeApp);

                        if (excludeNode) {
                            productNode.insertBefore(exNode, excludeNode);
                        } else {
                            productNode.appendChild(exNode);
                        }
                    }
                }
            }

            var exCount = getExcludeAppNodeCount(xmlDoc, selectedProduct);
            $("#btRemoveExcludeApp").prop("disabled", !(exCount > 0));
        }

        function odtRemoveExcludeApp(xmlDoc) {
            var selectedProduct = $("#cbProduct").val();
            var selectExcludeApp = $("#cbExcludeApp").val();

            var addNode = null;

            var nodes = xmlDoc.documentElement.getElementsByTagName("Add");
            if (nodes.length > 0) {
                addNode = xmlDoc.documentElement.getElementsByTagName("Add")[0];

                var productNode = getProductNode(addNode, selectedProduct);
                if (productNode) {
                    if (getExcludeAppNodeCount(xmlDoc, selectedProduct) > 0) {
                        var exNode = getExcludeAppNode(productNode, selectExcludeApp);
                        if (exNode) {
                            productNode.removeChild(exNode);
                        }
                    }
                }
            }

            var langCount = getExcludeAppNodeCount(xmlDoc, selectedProduct);
            $("#btRemoveExcludeApp").prop("disabled", !(langCount > 0));
        }


        function getExcludeAppNode(excludeAppNode, selectedExcludeApp) {
            var exNode = null;
            var excludeApps = excludeAppNode.getElementsByTagName("ExcludeApp");
            for (var i = 0; i < excludeApps.length; i++) //looping xml childnodes
            {
                var excludeApp = excludeApps[i];
                var excludeAppId = excludeApp.getAttribute("ID");

                if (excludeAppId == selectedExcludeApp) {
                    exNode = excludeApp;
                }
            }
            return exNode;
        }

        function getExcludeAppNodeCount(xmlDoc, productId) {
            var addNode = xmlDoc.createElement("Add");

            var nodes = xmlDoc.documentElement.getElementsByTagName("Add");
            if (nodes.length > 0) {
                addNode = xmlDoc.documentElement.getElementsByTagName("Add")[0];

                var productNode = getProductNode(addNode, productId);
                if (productNode) {
                    var excludeApps = productNode.getElementsByTagName("ExcludeApp");
                    return excludeApps.length;
                }
            }

            return 0;
        }


        function odtAddProduct(xmlDoc) {
            var selectedProduct = $("#cbProduct").val();
            var selectBitness = $("#cbEdition").val();
            var selectVersion = $("#txtVersion").val();
            var selectSourcePath = $("#txtSourcePath").val();
            var selectLanguage = $("#cbLanguage").val();
            var selectPidKey = $("#txtPidKey").val();

            var addNode = xmlDoc.createElement("Add");
            var nodes = xmlDoc.documentElement.getElementsByTagName("Add");
            if (nodes.length > 0) {
                addNode = xmlDoc.documentElement.getElementsByTagName("Add")[0];
            } else {
                xmlDoc.documentElement.appendChild(addNode);
            }

            if (selectSourcePath) {
                addNode.setAttribute("SourcePath", selectSourcePath);
            } else {
                addNode.removeAttribute("SourcePath");
            }

            if (selectVersion) {
                addNode.setAttribute("Version", selectVersion);
            } else {
                addNode.removeAttribute("Version");
            }

            addNode.setAttribute("OfficeClientEdition", selectBitness);

            var productNode = getProductNode(addNode, selectedProduct);
            if (!(productNode)) {
                productNode = xmlDoc.createElement("Product");
                productNode.setAttribute("ID", selectedProduct);
                addNode.appendChild(productNode);
            }

            if (selectPidKey) {
                productNode.setAttribute("PIDKEY", selectPidKey);
            } else {
                productNode.removeAttribute("PIDKEY");
            }

            var langNode = getLanguageNode(productNode, selectLanguage);
            if (!(langNode)) {
                langNode = xmlDoc.createElement("Language");
                langNode.setAttribute("ID", selectLanguage);
                productNode.appendChild(langNode);
            }

            var removeNode = null;
            var removeNodes = xmlDoc.documentElement.getElementsByTagName("Remove");
            if (removeNodes.length > 0) {
                removeNode = xmlDoc.documentElement.getElementsByTagName("Remove")[0];
            }

            if (removeNode) {
                var existingRemoveProduct = checkForRemoveProductNode(xmlDoc, selectedProduct);
                if (existingRemoveProduct) {
                    removeNode.removeChild(existingRemoveProduct);
                }

                if (removeNode.childElementCount == 0) {
                    xmlDoc.documentElement.removeChild(removeNode);
                }
            }

            var productCount = getAddProductCount(xmlDoc);
            if (productCount == 0) {
                $("#btRemoveProduct").prop("disabled", true);
                $("#btAddLanguage").prop("disabled", true);
                $("#btRemoveLanguage").prop("disabled", true);
            } else {
                $("#btRemoveProduct").prop("disabled", false);
                $("#btAddLanguage").prop("disabled", true);
            }
        }

        function odtRemoveProduct(xmlDoc) {
            var selectedProduct = $("#cbProduct").val();

            var addNode = null;

            var nodes = xmlDoc.documentElement.getElementsByTagName("Add");
            if (nodes.length > 0) {
                addNode = xmlDoc.documentElement.getElementsByTagName("Add")[0];

                var productNode = getProductNode(addNode, selectedProduct);
                if (productNode) {
                    addNode.removeChild(productNode);
                }

                var products = addNode.getElementsByTagName("Product");
                if (products.length == 0) {
                    addNode.parentNode.removeChild(addNode);
                }
            }

            var productCount = getAddProductCount(xmlDoc);
            if (productCount == 0) {
                $("#btRemoveProduct").prop("disabled", true);
                $("#btAddLanguage").prop("disabled", true);
                $("#btRemoveLanguage").prop("disabled", true);
            } else {
                $("#btRemoveProduct").prop("disabled", false);
                $("#btAddLanguage").prop("disabled", false);
            }

            //$("#removeAllProducts").removeClass('btn-primary');
            //$("#removeSelectProducts").removeClass('btn-primary');
            //$("#removeAllProducts").removeClass('active');
            //$("#removeSelectProducts").removeClass('active');

            $("#btAddProduct").text('Add Product');
        }


        function odtSaveUpdates(xmlDoc) {
            var selectUpdatePath = $("#txtUpdatePath").val();
            var selectTargetVersion = $("#txtTargetVersion").val();
            var selectDeadline = $("#txtDeadline").val();

            var $btUpdatesEnabled = $("#btupdatesEnabled");
            var $btUpdatesDisabled = $("#btupdatesDisabled");

            if ($btUpdatesEnabled.hasClass('btn-primary') || $btUpdatesDisabled.hasClass('btn-primary')) {

                var addNode = xmlDoc.createElement("Update");
                var nodes = xmlDoc.documentElement.getElementsByTagName("Update");
                if (nodes.length > 0) {
                    addNode = xmlDoc.documentElement.getElementsByTagName("Update")[0];
                } else {
                    xmlDoc.documentElement.appendChild(addNode);
                }

                if (selectUpdatePath) {
                    addNode.setAttribute("UpdatePath", selectUpdatePath);
                } else {
                    addNode.removeAttribute("UpdatePath");
                }

                if (selectTargetVersion) {
                    addNode.setAttribute("TargetVersion", selectTargetVersion);
                } else {
                    addNode.removeAttribute("TargetVersion");
                }

                if (selectDeadline) {
                    addNode.setAttribute("Deadline", selectDeadline);
                } else {
                    addNode.removeAttribute("Deadline");
                }

                if ($btUpdatesEnabled.hasClass('btn-primary')) {
                    addNode.setAttribute("Enabled", "TRUE");
                }

                if ($btUpdatesDisabled.hasClass('btn-primary')) {
                    addNode.setAttribute("Enabled", "FALSE");
                    addNode.removeAttribute("UpdatePath");
                    addNode.removeAttribute("TargetVersion");
                    addNode.removeAttribute("Deadline");
                }

            }
        }

        function odtRemoveUpdates(xmlDoc) {
            var addNode = xmlDoc.createElement("Update");
            var nodes = xmlDoc.documentElement.getElementsByTagName("Update");
            if (nodes.length > 0) {
                addNode = xmlDoc.documentElement.getElementsByTagName("Update")[0];
                if (addNode) {
                    xmlDoc.documentElement.removeChild(addNode);
                }
            }

            $("#btupdatesDisabled").removeClass('btn-primary');
            $("#btupdatesEnabled").removeClass('btn-primary');
            $("#btupdatesDisabled").removeClass('active');
            $("#btupdatesEnabled").removeClass('active');

            $("#txtUpdatePath").prop("disabled", true);
            $("#txtTargetVersion").prop("disabled", true);
            $("#txtDeadline").prop("disabled", true);
        }


        function odtSaveDisplay(xmlDoc) {
            var addNode = xmlDoc.createElement("Display");
            var nodes = xmlDoc.documentElement.getElementsByTagName("Display");
            if (nodes.length > 0) {
                addNode = xmlDoc.documentElement.getElementsByTagName("Display")[0];
            } else {
                xmlDoc.documentElement.appendChild(addNode);
            }

            var $displayLevelNone = $("#btLevelNone");
            if ($displayLevelNone.hasClass('btn-primary')) {
                addNode.setAttribute("Level", "None");
            } else {
                addNode.setAttribute("Level", "Full");
            }

            var $AcceptEulaEnabled = $("#btAcceptEULAEnabled");
            if ($AcceptEulaEnabled.hasClass('btn-primary')) {
                addNode.setAttribute("AcceptEULA", "TRUE");
            } else {
                addNode.setAttribute("AcceptEULA", "FALSE");
            }
        }

        function odtRemoveDisplay(xmlDoc) {
            var addNode = xmlDoc.createElement("Display");
            var nodes = xmlDoc.documentElement.getElementsByTagName("Display");
            if (nodes.length > 0) {
                addNode = xmlDoc.documentElement.getElementsByTagName("Display")[0];
                if (addNode) {
                    xmlDoc.documentElement.removeChild(addNode);
                }
            }

            $("#btLevelNone").removeClass('btn-primary');
            $("#btLevelFull").removeClass('btn-primary');
            $("#btLevelNone").removeClass('active');
            $("#btLevelFull").removeClass('active');

            $("#btAcceptEULAEnabled").removeClass('btn-primary');
            $("#btAcceptEULAEnabled").removeClass('active');
            $("#btAcceptEULADisabled").removeClass('btn-primary');
            $("#btAcceptEULADisabled").removeClass('active');
        }



        function odtSaveLogging(xmlDoc) {
            var loggingUpdatePath = $("#txtLoggingUpdatePath").val();
            var $displayLevelNone = $("#btLoggingLevelOff");
            var $displayLevelStandard = $("#btLoggingLevelStandard");

            if ($displayLevelNone.hasClass('btn-primary') || $displayLevelStandard.hasClass('btn-primary')) {
                var addNode = xmlDoc.createElement("Logging");
                var nodes = xmlDoc.documentElement.getElementsByTagName("Logging");
                if (nodes.length > 0) {
                    addNode = xmlDoc.documentElement.getElementsByTagName("Logging")[0];
                } else {
                    xmlDoc.documentElement.appendChild(addNode);
                }

                if ($displayLevelNone.hasClass('btn-primary')) {
                    addNode.setAttribute("Level", "Off");
                }

                if ($displayLevelStandard.hasClass('btn-primary')) {
                    addNode.setAttribute("Level", "Standard");
                }

                if (loggingUpdatePath) {
                    addNode.setAttribute("Path", loggingUpdatePath);
                } else {
                    addNode.removeAttribute("Path");
                }
            }
        }

        function odtRemoveLogging(xmlDoc) {
            var addNode = xmlDoc.createElement("Logging");
            var nodes = xmlDoc.documentElement.getElementsByTagName("Logging");
            if (nodes.length > 0) {
                addNode = xmlDoc.documentElement.getElementsByTagName("Logging")[0];
                if (addNode) {
                    xmlDoc.documentElement.removeChild(addNode);
                }
            }

            $("#btLoggingLevelOff").removeClass('btn-primary');
            $("#btLoggingLevelOff").removeClass('active');
            $("#btLoggingLevelStandard").removeClass('btn-primary');
            $("#btLoggingLevelStandard").removeClass('active');
        }


        function getProductNode(addNode, selectedProduct) {
            var productNode = null;
            var products = addNode.getElementsByTagName("Product");
            for (var i = 0; i < products.length; i++) //looping xml childnodes
            {
                var product = products[i];
                var productId = product.getAttribute("ID");

                if (productId == selectedProduct) {
                    productNode = product;
                }
            }
            return productNode;
        }

        function getAddProductCount(xmlDoc) {
            var nodes = xmlDoc.documentElement.getElementsByTagName("Add");
            if (nodes.length > 0) {
                var addNode = xmlDoc.documentElement.getElementsByTagName("Add")[0];

                var products = addNode.getElementsByTagName("Product");
                return products.length;
            }
            return 0;
        }

        function checkForAddProductNode(xmlDoc, selectedProduct) {
            var addNode = xmlDoc.createElement("Add");
            var nodes = xmlDoc.documentElement.getElementsByTagName("Add");
            if (nodes.length > 0) {
                addNode = xmlDoc.documentElement.getElementsByTagName("Add")[0];
            } else {
                xmlDoc.documentElement.appendChild(addNode);
            }

            var productNode = getProductNode(addNode, selectedProduct);
            return productNode;
        }

        function checkForRemoveProductNode(xmlDoc, selectedProduct) {
            var removeNode = xmlDoc.createElement("Remove");
            var nodes = xmlDoc.documentElement.getElementsByTagName("Remove");
            if (nodes.length > 0) {
                removeNode = xmlDoc.documentElement.getElementsByTagName("Remove")[0];
            } else {
                xmlDoc.documentElement.appendChild(removeNode);
            }

            var productNode = getProductNode(removeNode, selectedProduct);
            return productNode;
        }



        function getLanguageNode(productNode, selectedLanguage) {
            var langNode = null;
            var languages = productNode.getElementsByTagName("Language");
            for (var i = 0; i < languages.length; i++) //looping xml childnodes
            {
                var language = languages[i];
                var languageId = language.getAttribute("ID");

                if (languageId == selectedLanguage) {
                    langNode = language;
                }
            }
            return langNode;
        }

        function getLanguageNodeCount(xmlDoc, productId) {
            var addNode = xmlDoc.createElement("Add");

            var nodes = xmlDoc.documentElement.getElementsByTagName("Add");
            if (nodes.length > 0) {
                addNode = xmlDoc.documentElement.getElementsByTagName("Add")[0];

                var productNode = getProductNode(addNode, productId);
                if (productNode) {
                    var languages = productNode.getElementsByTagName("Language");
                    return languages.length;
                }
            }

            return 0;
        }

        function getRemoveLanguageNodeCount(xmlDoc, productId) {
            var addNode = xmlDoc.createElement("Remove");

            var nodes = xmlDoc.documentElement.getElementsByTagName("Remove");
            if (nodes.length > 0) {
                addNode = xmlDoc.documentElement.getElementsByTagName("Remove")[0];

                var productNode = getProductNode(addNode, productId);
                if (productNode) {
                    var languages = productNode.getElementsByTagName("Language");
                    return languages.length;
                }
            }

            return 0;
        }


        function createXmlDocument(string) {
            var doc;
            if (window.DOMParser) {
                parser = new DOMParser();
                doc = parser.parseFromString(string, "application/xml");
            }
            else // Internet Explorer
            {
                doc = new ActiveXObject("Microsoft.XMLDOM");
                doc.async = "false";
                doc.loadXML(string);
            }
            return doc;
        }

        function displayXml(xmlDoc) {
            var xmlString = (new XMLSerializer().serializeToString(xmlDoc.documentElement));
            var xmlOutput = vkbeautify.xml(xmlString);
            $('textarea#xmlText').val(xmlOutput);
        }

        function toggleRemove(sourceId) {

            if (sourceId.toLowerCase() == "removeallproducts") {
                $("#removeSelectProducts").removeClass('active');
                $("#removeSelectProducts").removeClass('btn-primary');

                var $this = $("#removeAllProducts");
                if (!$this.hasClass('active')) {
                    $this.addClass('active');
                }

                if (!$this.hasClass('btn-primary')) {
                    $this.addClass('btn-primary');
                }

                $("#cbRemoveProduct").prop("disabled", true);
                $("#cbRemoveLanguage").prop("disabled", true);
                $("#btAddRemoveLanguage").prop("disabled", true);
            } else {
                $("#removeAllProducts").removeClass('active');
                $("#removeAllProducts").removeClass('btn-primary');

                var $this = $("#removeSelectProducts");
                if (!$this.hasClass('active')) {
                    $this.addClass('active');
                }

                if (!$this.hasClass('btn-primary')) {
                    $this.addClass('btn-primary');
                }

                $("#cbRemoveProduct").prop("disabled", false);
                $("#cbRemoveLanguage").prop("disabled", false);
                $("#btAddRemoveLanguage").prop("disabled", false);
            }

        }

        function toggleUpdatesEnabled(sourceId) {

            if (sourceId.toLowerCase() == "btupdatesenabled") {
                //$("#btupdatesDisabled").removeClass('active');
                $("#btupdatesDisabled").removeClass('btn-primary');

                var $this = $("#btupdatesEnabled");
                //if (!$this.hasClass('active')) {
                //    $this.addClass('active');
                //}

                if (!$this.hasClass('btn-primary')) {
                    $this.addClass('btn-primary');
                }

                $("#txtUpdatePath").prop("disabled", false);
                $("#txtTargetVersion").prop("disabled", false);
                $("#txtDeadline").prop("disabled", false);
            } else {
                //$("#btupdatesEnabled").removeClass('active');
                $("#btupdatesEnabled").removeClass('btn-primary');

                var $this = $("#btupdatesDisabled");
                //if (!$this.hasClass('active')) {
                //    $this.addClass('active');
                //}

                if (!$this.hasClass('btn-primary')) {
                    $this.addClass('btn-primary');
                }

                $("#txtUpdatePath").prop("disabled", true);
                $("#txtTargetVersion").prop("disabled", true);
                $("#txtDeadline").prop("disabled", true);
            }
            return false;
        }

        function toggleDisplayLevelEnabled(sourceId) {

            if (sourceId.toLowerCase() == "btlevelnone") {
                $("#btLevelFull").removeClass('active');
                $("#btLevelFull").removeClass('btn-primary');

                var $this = $("#btLevelNone");
                if (!$this.hasClass('active')) {
                    $this.addClass('active');
                }

                if (!$this.hasClass('btn-primary')) {
                    $this.addClass('btn-primary');
                }
            } else {
                $("#btLevelNone").removeClass('active');
                $("#btLevelNone").removeClass('btn-primary');

                var $this = $("#btLevelFull");
                if (!$this.hasClass('active')) {
                    $this.addClass('active');
                }

                if (!$this.hasClass('btn-primary')) {
                    $this.addClass('btn-primary');
                }
            }

        }

        function toggleDisplayEULAEnabled(sourceId) {

            if (sourceId.toLowerCase() == "btaccepteulaenabled") {
                $("#btAcceptEULADisabled").removeClass('active');
                $("#btAcceptEULADisabled").removeClass('btn-primary');

                var $this = $("#btAcceptEULAEnabled");
                if (!$this.hasClass('active')) {
                    $this.addClass('active');
                }

                if (!$this.hasClass('btn-primary')) {
                    $this.addClass('btn-primary');
                }
            } else {
                $("#btAcceptEULAEnabled").removeClass('active');
                $("#btAcceptEULAEnabled").removeClass('btn-primary');

                var $this = $("#btAcceptEULADisabled");
                if (!$this.hasClass('active')) {
                    $this.addClass('active');
                }

                if (!$this.hasClass('btn-primary')) {
                    $this.addClass('btn-primary');
                }
            }

        }

        function toggleLoggingEnabled(sourceId) {

            if (sourceId.toLowerCase() == "btloggingleveloff") {
                $("#btLoggingLevelStandard").removeClass('active');
                $("#btLoggingLevelStandard").removeClass('btn-primary');

                var $this = $("#btLoggingLevelOff");
                if (!$this.hasClass('active')) {
                    $this.addClass('active');
                }

                if (!$this.hasClass('btn-primary')) {
                    $this.addClass('btn-primary');
                }
            } else {
                $("#btLoggingLevelOff").removeClass('active');
                $("#btLoggingLevelOff").removeClass('btn-primary');

                var $this = $("#btLoggingLevelStandard");
                if (!$this.hasClass('active')) {
                    $this.addClass('active');
                }

                if (!$this.hasClass('btn-primary')) {
                    $this.addClass('btn-primary');
                }
            }

        }

    </script>


</body>
</html>